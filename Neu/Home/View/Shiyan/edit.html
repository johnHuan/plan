<extend name="Public/base" />
<block name="title">实验教学大纲</block>
<block name="main">

    <div class="container-fluid">
        <div class="header">
            <h1 class="text-center">资土学院 实验教学大纲</h1>
        </div>
        <span class="glyphicon glyphicon-tasks" aria-hidden="true"></span>
        <form action="__SELF__" method="post">
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>当前状态：
                <span class="text-danger">信息不全!! 请及时修改</span>
                </thead>
                <tbody>
                <input type="hidden" name="id" value="{$data.id}">
                <tr>
                    <td>《
                        <input readonly value="{$data.CName}" name="CName" required type="text" class="inline-input" style="width: 20%;" placeholder="教学大纲名称">
                        》实验教学大纲
                    </td>
                </tr>
                <tr>
                    <td>Experiment Syllabus of
                        <input  value="{$data.EName}" name="EName" required type="text" class="inline-input" style="width: 85%; text-indent: 6px;" placeholder="XXXXXX">
                    </td>
                </tr>
                <tr>
                    <td>课程代码：
                        <input readonly value="{$data.CCode}" name="CCode" required type="text" class="inline-input" placeholder="字母C开头的课程编号">
                    </td>
                </tr>
                <tr>
                    <td>学时数：
                        <input readonly value="{$data.TNum}" name="TNum" required type="text" class="inline-input" placeholder="填写数字">学时
                    </td>
                </tr>
                <tr>
                    <td class="checkbox checkbox-info checkbox-circle">
                        实验要求：
                        <if condition="$data.shiYanYaoQiu eq '必修'">
                            <label><input required type="radio" name="shiYanYaoQiu" checked value="必修"> 必修</label>
                            <label><input  required type="radio" name="shiYanYaoQiu" value="选修"> 选修</label>
                        <else />
                            <label>必修</label><input required type="radio" name="shiYanYaoQiu"  value="必修">
                            <label>选修</label><input required type="radio" name="shiYanYaoQiu" checked value="选修">
                        </if>
                    </td>
                </tr>
                <tr>
                    <td>适用专业：
                        <select required name="SMajor" data-placeholder="==请选择适用专业==" class="selectpicker chosen-select " multiple data-done-button="true">
                            <switch name="data.SMajor">
                                <case value="测绘工程">
                                    <option selected value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="采矿工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option selected value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="土木工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option selected value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="安全工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option selected value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="环境工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option selected value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="矿物加工工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option selected value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <case value="资源勘查工程">
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option selected value="1014资源勘查工程">资源勘查工程</option>
                                </case>
                                <default />
                                    <option value="1007测绘工程">测绘工程  </option>
                                    <option value="1001采矿工程">采矿工程  </option>
                                    <option value="1009土木工程">土木工程  </option>
                                    <option value="1003安全工程">安全工程  </option>
                                    <option value="1005环境工程">环境工程  </option>
                                    <option value="1004矿物加工工程">矿物加工工程</option>
                                    <option value="1014资源勘查工程">资源勘查工程</option>
                            </switch>

                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="checkbox checkbox-info checkbox-circle">课程性质：　　　
                        <if condition="$data.KeChengXingZhi eq '独立设课'">
                            <label><input checked required type="radio" name="KeChengXingZhi" value="独立设课"> 独立设课</label>
                            <label><input required type="radio" name="KeChengXingZhi" value="非独立设课"> 非独立设课</label>
                        <else />
                            <label><input required type="radio" name="KeChengXingZhi" value="独立设课"> 独立设课</label>
                            <label><input checked required type="radio" name="KeChengXingZhi" value="非独立设课"> 非独立设课</label>
                        </if>
                    </td>
                </tr>
                <tr>
                    <td>课程负责人：
                        <input value="{$data.CMaster}" name="CMaster" required type="text" class="inline-input" style="width: 20%;;" placeholder="XXX">
                    </td>
                </tr>
                <tr>
                    <td>审核人：
                        <input value="{$data.CConductor}" name="CConductor" required type="text" class="inline-input" placeholder="XXX">
                    </td>
                </tr>
                <tr>
                    <td>批准人：
                        <input value="{$data.Allowed}" name="Allowed" type="text" required class="inline-input" placeholder="XXX">
                    </td>
                </tr>
                </tbody>
            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>一、课程目的与基本要求：</h4>
                </thead>
                <tbody>
                <tr>
                    <td>
                        1.实验目的
                    </td>
                </tr>
                <tr>
                    <td>
                        <textarea required name="destination" class="form-control" placeholder="编号直接用数字即可;eg:1.xxx; 2.xxx;">{$data.destination}</textarea>
                    </td>
                </tr>
                <tr>
                    <td>2. 基本要求</td>
                </tr>
                <tr>
                    <td>
                        <textarea required name="BasicRequire" class="form-control" placeholder="编号直接用数字;eg: 1.xxx; 2.xxx">{$data.BasicRequire}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>二、实验方式与要求</h4>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <textarea required name="StyleRequire" class="form-control" placeholder="编号直接用数字;eg: 1.xxx; 2.xxx">{$data.StyleRequire}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>三、实验项目及教学安排　　
                    <!--<a href="javascript:countIndex();" class="addRow small"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>不够写了？再添加一行吧:)</a>-->
                    <!--<button type="button" class="btn btn-defalut btn-small pull-right disabled" data-toggle="modal" data-target="#uploadExcel">上传Excel文件</button>-->
                </h4>

                </thead>
                <tbody class="addRowBody">
                <tr>
                    <td>序号：</td>
                    <td>实验名称</td>
                    <td>基本内容</td>
                    <td>实验学时</td>
                    <td>每组人数</td>
                    <td>实验要求</td>
                    <td>实验类型</td>
                    <!--<td>操作</td>-->
                </tr>
                <foreach name="dataTable" item="vo">
                    <tr>
                        <td style="width: 70px"><input required name="TestNum[]" type="text" class="inline-input" style="width: 100%" value="{$vo.TestNum}">
                        <td><input required name="TestName[]" type="text" class="inline-input" style="width: 100%" value="{$vo.TestName}"></td>
                        <td><input required name="TestBasicContent[]" type="text" class="inline-input" style="width: 100%" value="{$vo.TestBasicContent}"></td>
                        <td style="width: 70px"><input required name="TestXueShi[]" type="text" class="inline-input" style="width: 100%" value="{$vo.TestXueShi}"></td>
                        <td style="width: 70px"><input required name="TestPerTeam[]" type="text" class="inline-input" style="width: 100%;" value="{$vo.TestPerTeam}"></td>
                        <td style="width: 115px;">
                            <if condition="$vo.TestRequire eq '必修'">
                                <label><input type="radio" checked required name="TestRequire[{$vo.TestNum}]" value="必修">必修</label>
                                <label><input type="radio" required name="TestRequire[{$vo.TestNum}]" value="选修">选修</label>
                            <else />
                                <label><input type="radio" required name="TestRequire[{$vo.TestNum}]" value="必修">必修</label>
                                <label><input type="radio" checked required name="TestRequire[{$vo.TestNum}]" value="选修">选修</label>
                            </if>
                        </td>
                        <td nowrap="true">
                            <if condition="$vo.TestStyle eq '综合型'">
                                <label><input checked required type="radio" name="TestStyle[{$vo.TestNum}]" value="综合型">综合型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="设计型">设计型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="演示型">演示型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="验证型">验证型</label>
                            <elseif condition="$vo.TestStyle eq '设计型'" />
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="综合型">综合型</label>
                                <label><input checked required type="radio" name="TestStyle[{$vo.TestNum}]" value="设计型">设计型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="演示型">演示型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="验证型">验证型</label>
                            <elseif condition="$vo.TestStyle eq '演示型'" />
                                <label><input checked required type="radio" name="TestStyle[{$vo.TestNum}]" value="综合型">综合型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="设计型">设计型</label>
                                <label><input checked required type="radio" name="TestStyle[{$vo.TestNum}]" value="演示型">演示型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="验证型">验证型</label>
                            <elseif condition="$vo.TestStyle eq '验证型'" />
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="综合型">综合型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="设计型">设计型</label>
                                <label><input required type="radio" name="TestStyle[{$vo.TestNum}]" value="演示型">演示型</label>
                                <label><input checked required type="radio" name="TestStyle[{$vo.TestNum}]" value="验证型">验证型</label>
                            </if>

                        </td>
                        <!--<td style="width: 45px;"><a href="javascript:void(0);" onclick="clearRow(this)">删除</a></td></td>-->
                    </tr>
                </foreach>
                </tbody>

            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>四、场地设备</h4>
                </thead>
                <tbody>
                <tr>
                    <td>场地：<input value="{$data.TAddress}" required name="TAddress" type="text" class="inline-input" placeholder="XXX"></td>
                </tr>
                <tr>
                    <td>主要仪器设备：<input value="{$data.TInstrument}" required name="TInstrument" style="width: 90%;" type="text" class="inline-input" placeholder="XXX"></td>
                </tr>
                </tbody>
            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>五、考核方式与成绩评定办法</h4>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <textarea required name="TEvaluate" class="form-control">{$data.TEvaluate}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
            <table class="table table-condensed table-bordered table-striped table-hover">
                <thead>
                <h4>六、实验教材及参考书</h4>
                </thead>
                <tbody>
                <tr>
                    <td>
                        <textarea required name="TBook" class="form-control" placeholder="eg:[1] 崔坚主编.SIMATIC S7-1500与TIA博途软件使用指南.北京:工业出版社.2016">{$data.TBook}</textarea>
                    </td>
                </tr>
                </tbody>
            </table>
            <!--
            <div class="form-group col-md-4">
                <button class="form-control btn btn-primary" >预览</button>
            </div>
            -->
            <div class="form-group col-md-4">
                <input class="form-control btn btn-primary" value="确认提交" type="submit" >
            </div>
        </form>
    </div>

    <script type="text/javascript">
        // 只能用定义全局变量的方式来记录点击生成表格的行数了
        var i = 0;
        function countIndex() {
            i++;
        }
        $(function (){
            $('.addRow').on('click', function (index) {
                var flag = index.timeStamp.toString().substr(0, 4);
                var newRow = document.createElement("tr");
                var ibody = $('.addRowBody')[0];

                var td1 = document.createElement("td");
                td1.innerHTML="<input name=\"TestNum[]\" required type=\"text\" class=\"inline-input\" style=\"width: 100%\">";
                newRow.appendChild(td1);

                var td2 = document.createElement("td");
                td2.innerHTML="<input name=\"TestName[]\" required type=\"text\" class=\"inline-input\" style=\"width: 100%\">";
                newRow.appendChild(td2);

                var td3 = document.createElement("td");
                td3.innerHTML="<input name=\"TestBasicContent[]\" required type=\"text\" class=\"inline-input\" style=\"width: 100%\">";
                newRow.appendChild(td3);

                var td4 = document.createElement("td");
                td4.innerHTML="<input name=\"TestXueShi[]\" required type=\"text\" class=\"inline-input\" style=\"width: 100%\">";
                newRow.appendChild(td4);

                var td5 = document.createElement("td");
                td5.innerHTML="<input name=\"TestPerTeam[]\" required type=\"text\" class=\"inline-input\" style=\"width: 100%\">";
                newRow.appendChild(td5);

                var td6 = document.createElement("td");
                td6.setAttribute('style', 'width:115px');
                td6.innerHTML="<label><input type=\"radio\" required name=\"TestRequire["+i+"]\" value=\"必修\">必修 </label> <label><input type=\"radio\" name=\"TestRequire["+i+"]\" value=\"选修\">选修</label>";
//            td6.innerHTML="<input name=\"TestRequire[]\" type=\"text\" class=\"inline-input\" style=\"width: 100%\" placeholder='填：必修或选修' required>";
                newRow.appendChild(td6);

                var td7 = document.createElement("td");
                td7.setAttribute('nowrap', 'true');
//            td7.innerHTML="<input name=\"TestStyle[]\" type=\"text\" class=\"inline-input\" style=\"width: 100%\" placeholder='从上一行的单选按钮中选一个填写'>";
                td7.innerHTML="<label><input type=\"radio\" required name=\"TestStyle["+i+"]\" value=\"综合型\">综合型</label> <label><input type=\"radio\" name=\"TestStyle["+i+"]\" value=\"设计型\">设计型</label> <label><input type=\"radio\" name=\"TestStyle["+i+"]\" value=\"演示型\">演示型</label> <label><input type=\"radio\" name=\"TestStyle["+i+"]\" value=\"验证型\">验证型</label>";
                newRow.appendChild(td7);

                var td8=document.createElement("td");
                td8.innerHTML="<a href=\"javascript:;\" onclick=\"clearRow(this)\">删除</a>";
                td8.setAttribute('style', 'width:45px;');
                newRow.appendChild(td8);
                ibody.appendChild(newRow);

            });

            $('input[name="CCode"]').on('blur', function () {
                $('input[name="hiddenCCode"]').val(this.value);
                var val = parseInt(this.value.substr(1, 4));
                switch (val) {
                    case 1001:
                        console.log('caojianli');
                        $('input[name="CConductor"]').val('曹建立');
                        break;
                    case 1003:
                        $('input[name="CConductor"]').val('郑欣');
                        break;
                    case 1004:
                        $('input[name="CConductor"]').val('高淑玲');
                        break;
                    case 1005:
                        $('input[name="CConductor"]').val('张铭川');
                        break;
                    case 1007:
                        $('input[name="CConductor"]').val('马保东');
                        break;
                    case 1009:
                        $('input[name="CConductor"]').val('陈猛');
                        break;
                    case 1014:
                        $('input[name="CConductor"]').val('陈家富');
                        break;
                }

                // 将课程代码通过ajax发送到服务器上去
                if(this.value.trim().length == 11){
                    $.ajax({
                        type: 'post',
                        url: '__CONTROLLER__/dealExcel',
                        data: this.value,
                        success: function (response) {
                            console.log(response);
                        }
                    });
                }
            });

            /*
             $('#upload').on('click', function (e) {
             e.preventDefault();
             //            console.log($('#formExcel'));
             var formData = new FormData($('#formExcel'));
             //            console.log(formData);

             $.ajax({
             url: '__CONTROLLER__/dealExcel',
             type: 'post',
             data: formData,
             beforeSend: function () {
             $('.btn-upload').addClass('disabled').html('数据交互中请稍后...');
             },
             success: function (response) {
             console.log(response);
             },
             error: function (e) {
             console.log('ajax上传出错！'+e.error);
             },
             complete: function () {
             $('.btn-upload').removeClass('disabled').html('上传');
             }
             })

             });

             */

        });

        // 创建表格删除函数
        function clearRow(obj) {
            var ibody = $('.addRowBody')[0].lastChild;
            var c = obj.parentNode.parentNode;
            c.parentNode.removeChild(c);

        }

    </script>


</block>


